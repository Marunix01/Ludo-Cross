<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ludo Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      margin: 0;
      text-align: center;
    }
    #start-screen, #settings {
      position: fixed;
      inset: 0;
      background: linear-gradient(#ffddcc, #ffeeee);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    #start-screen h1, #settings h2 {
      font-size: 2em;
      margin-bottom: 20px;
    }
    button {
      font-size: 16px;
      padding: 10px 20px;
      margin: 5px;
    }
    label {
      font-size: 14px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(15, 24px);
      grid-template-rows: repeat(15, 24px);
      margin: 10px auto;
      width: fit-content;
      gap: 1px;
    }
    .cell {
      width: 24px;
      height: 24px;
      background: white;
      border: 1px solid #ccc;
      position: relative;
    }
    .path { background: #ddd; }
    .safe { background: #b0e0e6; }
    .home-red { background: #faa; }
    .home-green { background: #afa; }
    .home-blue { background: #aaf; }
    .home-yellow { background: #ffb; }
    .token {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      position: absolute;
      top: 4px;
      left: 4px;
    }
    .red { background: red; }
    .green { background: green; }
    .blue { background: blue; }
    .yellow { background: goldenrod; }
    #ui, #scoreboard {
      margin-top: 10px;
    }
    #music-toggle {
      position: fixed;
      top: 10px;
      right: 10px;
    }
  </style>
</head>
<body>
  <div id="start-screen">
    <h1>Ludo Game</h1>
    <button onclick="showSettings()">Play</button>
  </div>  <div id="settings" style="display:none;">
    <h2>Game Settings</h2>
    <label>Number of Players: <input type="number" id="player-count" min="1" max="4" value="2"></label>
    <label><input type="checkbox" id="use-bots" checked> Fill empty slots with bots</label>
    <button onclick="startGame()">Start Game</button>
  </div><button id="music-toggle" onclick="toggleMusic()">Toggle Music</button> <audio id="bg-music" loop> <source src="https://www.bensound.com/bensound-music/bensound-funkyelement.mp3" type="audio/mpeg"> </audio>

  <div id="board"></div>  <div id="scoreboard">
    <h3>Scoreboard</h3>
    <ul id="score"></ul>
  </div>  <div id="ui">
    <button onclick="rollDice()">Roll Dice</button>
    <button onclick="restartGame()">Restart</button>
    <p id="diceText">Dice: -</p>
    <p id="log">Player: -</p>
  </div>  <script>
    let board = document.getElementById("board");
    let diceText = document.getElementById("diceText");
    let log = document.getElementById("log");
    let scoreList = document.getElementById("score");
    let music = document.getElementById("bg-music");
    let startScreen = document.getElementById("start-screen");
    let settingsScreen = document.getElementById("settings");

    let grid = [];
    let allPlayers = ["red", "green", "yellow", "blue"];
    let activePlayers = [];
    let bots = {};
    let playerTokens = {};
    let playerScores = {};
    let path = [], safeIndexes = [0, 8, 13, 21, 26, 34, 39, 47];
    let turn = 0;
    let dice = 0;

    function showSettings() {
      startScreen.style.display = 'none';
      settingsScreen.style.display = 'flex';
    }

    function startGame() {
      settingsScreen.style.display = 'none';
      let count = parseInt(document.getElementById("player-count").value);
      let useBots = document.getElementById("use-bots").checked;
      activePlayers = allPlayers.slice(0, count);
      for (let i = count; i < 4; i++) {
        if (useBots) {
          activePlayers.push(allPlayers[i]);
          bots[allPlayers[i]] = true;
        }
      }
      resetGame();
      music.play();
    }

    function toggleMusic() {
      music.paused ? music.play() : music.pause();
    }

    function restartGame() {
      location.reload();
    }

    function resetGame() {
      board.innerHTML = "";
      grid = [];
      playerTokens = {};
      playerScores = {};
      turn = 0;
      createBoard();
      activePlayers.forEach(p => {
        playerTokens[p] = [0, 0, 0, 0];
        playerScores[p] = 0;
      });
      updateScoreboard();
      log.textContent = "Player: " + activePlayers[turn];
    }

    function createBoard() {
      const basicPath = [
        7, 8, 9, 10, 11, 12, 13, 28, 43, 58, 73, 88, 103, 102, 101, 100, 99, 98,
        97, 82, 67, 52, 37, 22, 21, 20, 19, 18, 17, 2, 1, 0, 15, 30, 45, 60, 75, 90,
        105, 106, 107, 108, 109, 110, 111, 96, 81, 66, 51, 36, 35, 34
      ];
      path = basicPath;

      for (let i = 0; i < 225; i++) {
        let cell = document.createElement("div");
        cell.classList.add("cell");
        board.appendChild(cell);
        grid.push(cell);
      }
      path.forEach((i, idx) => {
        grid[i].classList.add("path");
        if (safeIndexes.includes(idx)) grid[i].classList.add("safe");
      });
    }

    function updateScoreboard() {
      scoreList.innerHTML = activePlayers.map(p => `<li>${p}: ${playerScores[p]} finished</li>`).join('');
    }

    function rollDice() {
      dice = Math.floor(Math.random() * 6) + 1;
      diceText.textContent = "Dice: " + dice;
      let currentPlayer = activePlayers[turn];
      log.textContent = `Player: ${currentPlayer}`;
      if (bots[currentPlayer]) {
        setTimeout(() => moveBot(currentPlayer), 1000);
      } else {
        setTimeout(() => allowMove(currentPlayer), 300);
      }
    }

    function moveBot(player) {
      let tokens = playerTokens[player];
      for (let i = 0; i < 4; i++) {
        if (tokens[i] + dice < path.length) {
          moveToken(player, i);
          return;
        }
      }
      nextTurn();
    }

    function allowMove(player) {
      let tokens = playerTokens[player];
      for (let i = 0; i < 4; i++) {
        let pos = tokens[i];
        let newPos = pos + dice;
        if (newPos < path.length) {
          grid[path[newPos]].onclick = () => {
            moveToken(player, i);
            disableAllClicks();
          }
        }
      }
    }

    function moveToken(player, index) {
      let pos = playerTokens[player][index];
      let newPos = pos + dice;
      if (newPos >= path.length) {
        playerScores[player]++;
        playerTokens[player][index] = path.length + 1;
        updateScoreboard();
        if (playerScores[player] === 4) {
          log.textContent = `${player.toUpperCase()} WINS!`;
          return;
        }
        nextTurn();
        return;
      }
      grid[path[pos]].innerHTML = "";
      playerTokens[player][index] = newPos;
      let token = document.createElement("div");
      token.className = `token ${player}`;
      grid[path[newPos]].appendChild(token);
      nextTurn();
    }

    function disableAllClicks() {
      grid.forEach(cell => cell.onclick = null);
    }

    function nextTurn() {
      if (dice !== 6) turn = (turn + 1) % activePlayers.length;
      log.textContent = "Player: " + activePlayers[turn];
    }
  </script></body>
</html>
